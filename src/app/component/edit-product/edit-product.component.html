<div *ngIf="showModal" class="modal-overlay" (click)="onOverlayClick($event)">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <button class="close-btn" (click)="closeModal()">×</button>

    <div *ngIf="product" class="product-detail-container">
      <h2>Cập nhật sản phẩm</h2>

      <form (ngSubmit)="onSubmit()">
        <div class="product-detail">
          <!-- Ảnh và thông tin chung -->
          <div class="product-image">
            <img [src]="
                baseUrl + product.avatarProduct || 'path_to_placeholder_image'
              " alt="Product Image" />
          </div>
          <div class="product-info">
            <div class="info-row">
              <div>
                <strong>Mã sản phẩm:</strong>
                <input style="background-color: darkgrey" type="text" [(ngModel)]="product.productCode"
                  name="productCode" readonly />
              </div>
              <div>
                <strong>Tên sản phẩm:</strong>
                <input type="text" [(ngModel)]="product.productName" name="productName" required />
              </div>
            </div>

            <!-- <div class="subcategory-container">
              <strong>Danh mục</strong>
              <div *ngFor="let subcategory of subCategories" class="subcategory-item">
                <input
                  type="checkbox"
                  [value]="subcategory.subCategoryID"
                  [(ngModel)]="selectedSubCategoryIds"
                />
                <span>{{ subcategory.subCategoryName }}</span>
              </div>
            </div> -->

            <div>
              <strong>Giảm giá (%):</strong>
              <input type="number" [(ngModel)]="product.salePercent" name="salePercent" />
            </div>

            <div class="info-row">
              <div>
                <strong>Brand:</strong>
                <input type="text" [(ngModel)]="product.brandName" name="brandName" />
              </div>
              <div>
                <strong>Mô tả:</strong>
                <textarea [(ngModel)]="product.description" name="description"></textarea>
              </div>
            </div>
            <div>
              <strong>Hình ảnh bổ sung:</strong>
              <div *ngIf="product.imageProduct?.length > 0" class="additional-images">
                <img *ngFor="let image of product.imageProduct" [src]="baseUrl + image" alt="Additional Product Image"
                  class="additional-image" />
              </div>
              <span *ngIf="
                  !product.imageProduct || product.imageProduct.length === 0
                ">Không có hình ảnh bổ sung</span>
            </div>
          </div>
        </div>

        <div *ngIf="product" class="product-detail-list">
          <h4 style="margin-top: 15px; margin-bottom: -10px">
            Chi tiết sản phẩm
          </h4>

          <!-- Nếu sản phẩm là Chuột -->
          <div *ngIf="product.categoryID === 1" class="table-responsive">
            <table class="detail-table">
              <thead>
                <tr>
                  <th>STT</th>
                  <th>Màu</th>
                  <th>Giá</th>
                  <th>Switch</th>
                  <th>DPI</th>
                  <th>Kết nối</th>
                  <th>Chất liệu</th>
                  <th>LED</th>
                  <th>Size</th>
                  <th>Tần số quét</th>
                  <th>Phần mềm hỗ trợ</th>
                  <th>Dung lượng pin (mhw)</th>
                  <th>Trọng lượng (gam)</th>
                  <th>Số lượng</th>
                  <th>Hành động</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let detail of product.productDetail; let i = index">
                  <td>{{ i + 1 }}</td>
                  <td>
                    <input type="text" [(ngModel)]="detail.color" [name]="'color' + i" />
                  </td>
                  <td>
                    <input type="text" [(ngModel)]="detail.price" [name]="'price' + i" />
                  </td>
                  <td>
                    <input type="text" [(ngModel)]="detail.switch" [name]="'switch' + i" />
                  </td>
                  <td>
                    <input type="text" [(ngModel)]="detail.dpi" [name]="'dpi' + i" />
                  </td>
                  <td>
                    <input type="text" [(ngModel)]="detail.connectivity" [name]="'connectivity' + i" />
                  </td>
                  <td>
                    <input type="text" [(ngModel)]="detail.material" [name]="'material' + i" />
                  </td>
                  <td>
                    <input type="text" [(ngModel)]="detail.led" [name]="'led' + i" />
                  </td>
                  <td>
                    <input type="text" [(ngModel)]="detail.dimensions" [name]="'dimensions' + i" />
                  </td>
                  <td>
                    <input type="text" [(ngModel)]="detail.eyeReading" [name]="'eyeReading' + i" />
                  </td>
                  <td>
                    <input type="text" [(ngModel)]="detail.ss" [name]="'ss' + i" />
                  </td>
                  <td>
                    <input type="number" [(ngModel)]="detail.batteryCapacity" [name]="'batteryCapacity' + i" />
                  </td>
                  <td>
                    <input type="number" [(ngModel)]="detail.weight" [name]="'weight' + i" />
                  </td>
                  <td>
                    <input type="number" [(ngModel)]="detail.quantity" [name]="'quantity' + i" />
                  </td>
                  <td>
                    <button type="button" (click)="removeDetail(i)">Xóa</button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- Nếu sản phẩm là Bàn phím -->
          <div *ngIf="product.categoryID === 2" class="table-responsive">
            <table class="detail-table">
              <thead>
                <tr>
                  <th>STT</th>
                  <th>Màu</th>
                  <th>Giá</th>
                  <th>LED</th>
                  <th>Chất liệu keycap</th>
                  <th>Chất liệu switch</th>
                  <th>PCB</th>
                  <th>Layout</th>
                  <th>Chất liệu</th>
                  <th>Switch</th>
                  <th>Tuổi thọ</th>
                  <th>Phần mềm hỗ trợ</th>
                  <th>Kích thước</th>
                  <th>Trọng lượng (gam)</th>
                  <th>Số lượng</th>
                  <th>Hành động</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let detail of product.productDetail; let i = index">
                  <td>{{ i + 1 }}</td>
                  <td>
                    <input type="text" [(ngModel)]="detail.color" [name]="'color' + i" />
                  </td>
                  <td>
                    <input type="text" [(ngModel)]="detail.price" [name]="'price' + i" />
                  </td>
                  <td>
                    <input type="text" [(ngModel)]="detail.led" [name]="'led' + i" />
                  </td>
                  <td>
                    <input type="text" [(ngModel)]="detail.keycapMaterial" [name]="'keycapMaterial' + i" />
                  </td>
                  <td>
                    <input type="text" [(ngModel)]="detail.switchMaterial" [name]="'switchMaterial' + i" />
                  </td>
                  <td>
                    <input type="text" [(ngModel)]="detail.pcb" [name]="'pcb' + i" />
                  </td>
                  <td>
                    <input type="text" [(ngModel)]="detail.layout" [name]="'layout' + i" />
                  </td>
                  <td>
                    <input type="text" [(ngModel)]="detail.case" [name]="'case' + i" />
                  </td>
                  <td>
                    <input type="text" [(ngModel)]="detail.switch" [name]="'switch' + i" />
                  </td>
                  <td>
                    <input type="text" [(ngModel)]="detail.switchLife" [name]="'switchLife' + i" />
                  </td>
                  <td>
                    <input type="text" [(ngModel)]="detail.ss" [name]="'ss' + i" />
                  </td>
                  <td>
                    <input type="text" [(ngModel)]="detail.size" [name]="'size' + i" />
                  </td>
                  <td>
                    <input type="number" [(ngModel)]="detail.weight" [name]="'weight' + i" />
                  </td>
                  <td>
                    <input type="number" [(ngModel)]="detail.quantity" [name]="'quantity' + i" />
                  </td>
                  <td>
                    <button type="button" (click)="removeDetail(i)">Xóa</button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Nút hành động -->
        <div class="action-buttons">
          <button type="submit" class="action-btn">Lưu thay đổi</button>
          <button type="button" class="cancel-btn" (click)="closeModal()">
            Hủy
          </button>
        </div>
      </form>
    </div>
  </div>
</div>